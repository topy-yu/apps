<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å°é”¤å­å¤§ä½œæˆ˜ - é¼ æ ‡ç»ƒä¹ æ¸¸æˆ</title>
    <style>
        :root {
            --bg-color: #7cfc00;
            --hole-color: #4b3021;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            font-family: 'MicroSoft YaHei', sans-serif;
            overflow: hidden;
            user-select: none;
            /* è‡ªå®šä¹‰é”¤å­å…‰æ ‡ */
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40"><path d="M20 5 L35 20 L30 25 L15 10 Z" fill="%23888"/><path d="M15 10 L5 25 L10 30 L20 15 Z" fill="%23666"/><rect x="25" y="20" width="5" height="15" transform="rotate(-45 25 20)" fill="%235c4033"/></svg>') 10 10, auto;
        }

        #ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .score-board { font-size: 24px; font-weight: bold; color: #333; }
        .instructions { font-size: 14px; margin-top: 5px; color: #666; }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        /* é¼¹é¼ æ ·å¼ */
        .mole {
            position: absolute;
            width: 100px;
            height: 100px;
            cursor: inherit;
            transition: transform 0.1s;
        }

        .mole svg {
            width: 100%;
            height: 100%;
        }

        /* å‡»ä¸­æ•ˆæœ */
        .hammer-hit {
            animation: screenShake 0.15s ease-out;
        }

        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }

        /* å¼€å§‹é¡µé¢æ ·å¼ */
        .start-screen, .end-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            color: white;
        }
        
        .settings-panel {
            background: rgba(255,255,255,0.1);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            max-width: 500px;
        }
        
        .setting-group {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }
        
        .setting-group h3 {
            margin-top: 0;
            color: #ffa502;
        }
        
        .option-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .option-btn {
            padding: 10px 20px;
            border: 2px solid #666;
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: #ffa502;
        }
        
        .option-btn.active {
            background: #ffa502;
            border-color: #ffa502;
            color: black;
        }
        
        .start-btn {
            padding: 15px 40px;
            font-size: 20px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .start-btn:hover {
            background: #27ae60;
            transform: scale(1.05);
        }
        
        .hidden { display: none !important; }
    </style>
</head>
<body oncontextmenu="return false;">

    <!-- å¼€å§‹é¡µé¢ -->
    <div class="start-screen" id="startScreen">
        <div class="settings-panel">
            <h1>ğŸ”¨ å°é”¤å­å¤§ä½œæˆ˜</h1>
            <p>é€‰æ‹©ä½ çš„æ¸¸æˆè®¾ç½®</p>
            
            <div class="setting-group">
                <h3>â° æ¸¸æˆæ—¶é•¿</h3>
                <div class="option-buttons" id="timeOptions">
                    <button class="option-btn" data-time="30">30ç§’</button>
                    <button class="option-btn active" data-time="60">1åˆ†é’Ÿ</button>
                    <button class="option-btn" data-time="120">2åˆ†é’Ÿ</button>
                    <button class="option-btn" data-time="180">3åˆ†é’Ÿ</button>
                </div>
            </div>
            
            <div class="setting-group">
                <h3>ï¿½ æ¸¸æˆæ¨¡å¼</h3>
                <div class="option-buttons" id="modeOptions">
                    <button class="option-btn" data-mode="left">ğŸ”´ ä»…å·¦é”®</button>
                    <button class="option-btn" data-mode="right">ğŸ”µ ä»…å³é”®</button>
                    <button class="option-btn active" data-mode="both">ğŸ”´ğŸ”µ å·¦å³é”®</button>
                    <button class="option-btn" data-mode="all">ğŸ”´ğŸ”µğŸŸ¡ å…¨éƒ¨</button>
                </div>
            </div>
            
            <div class="setting-group">
                <h3>âš¡ æ¸¸æˆé€Ÿåº¦</h3>
                <div class="option-buttons" id="speedOptions">
                    <button class="option-btn" data-speed="slow">ğŸ¢ æ…¢é€Ÿ</button>
                    <button class="option-btn active" data-speed="normal">ğŸš¶ æ ‡å‡†</button>
                    <button class="option-btn" data-speed="fast">ğŸƒ å¿«é€Ÿ</button>
                    <button class="option-btn" data-speed="crazy">âš¡ ç–¯ç‹‚</button>
                </div>
            </div>
            
            <button class="start-btn" onclick="startGame()">å¼€å§‹æ¸¸æˆ</button>
        </div>
    </div>
    
    <!-- ç»“æŸé¡µé¢ -->
    <div class="end-screen hidden" id="endScreen">
        <div class="settings-panel">
            <h1>ğŸ‰ æ¸¸æˆç»“æŸ</h1>
            <div style="font-size: 48px; margin: 20px 0; color: #ffa502;" id="finalScore">0</div>
            <p>ä½ çš„æœ€ç»ˆå¾—åˆ†</p>
            <button class="start-btn" onclick="restartGame()">å†æ¥ä¸€å±€</button>
        </div>
    </div>

    <div id="ui-layer" class="hidden">
        <div class="score-board">å¾—åˆ†: <span id="score">0</span></div>
        <div class="score-board">æ—¶é—´: <span id="timer">60</span>s</div>
        <div class="instructions" id="instructions">
            ğŸ”´çº¢è‰²: å·¦é”®å•å‡» | ğŸ”µè“è‰²: å³é”®å•å‡» | ğŸŸ¡é‡‘è‰²: åŒå‡»
        </div>
        <button onclick="toggleFullScreen()" style="margin-top:10px;">å…¨å±æ¨¡å¼</button>
    </div>

    <div class="game-container hidden" id="gameCanvas"></div>

    <script>
        let score = 0;
        let gameTime = 60;
        let gameMode = 'both';
        let gameSpeed = 'normal';
        let gameInterval = null;
        let timerInterval = null;
        let remainingTime = 0;
        
        // é€Ÿåº¦é…ç½®
        const speedConfig = {
            slow: { interval: 4000, lifetime: 4000 },
            normal: { interval: 2500, lifetime: 3000 },
            fast: { interval: 1500, lifetime: 2500 },
            crazy: { interval: 800, lifetime: 1800 }
        };
        
        const gameCanvas = document.getElementById('gameCanvas');
        const scoreDisplay = document.getElementById('score');
        const timerDisplay = document.getElementById('timer');
        const instructionsDisplay = document.getElementById('instructions');

        // é¼¹é¼ å›¾å½¢èµ„æº (SVG)
        const moleSVGs = {
            normal: (color) => `<svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="40" fill="${color}" stroke="#333" stroke-width="2"/>
                <circle cx="35" cy="40" r="5" fill="white"/>
                <circle cx="65" cy="40" r="5" fill="white"/>
                <path d="M40 60 Q50 70 60 60" stroke="black" fill="none" stroke-width="3"/>
            </svg>`,
            hit: (color) => `<svg viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="40" fill="${color}" opacity="0.7" stroke="#333" stroke-width="2"/>
                <text x="30" y="45" font-size="20">X</text>
                <text x="55" y="45" font-size="20">X</text>
                <path d="M40 70 Q50 60 60 70" stroke="black" fill="none" stroke-width="3"/>
            </svg>`
        };

        function createMole() {
            const mole = document.createElement('div');
            mole.className = 'mole';
            
            // æ ¹æ®æ¸¸æˆæ¨¡å¼å†³å®šç±»å‹
            let type, color;
            if (gameMode === 'left') {
                type = 'click'; color = '#ff4757';
            } else if (gameMode === 'right') {
                type = 'context'; color = '#1e90ff';
            } else if (gameMode === 'both') {
                const rand = Math.random();
                if (rand < 0.5) { type = 'click'; color = '#ff4757'; }
                else { type = 'context'; color = '#1e90ff'; }
            } else { // gameMode === 'all'
                const rand = Math.random();
                if (rand < 0.4) { type = 'click'; color = '#ff4757'; }
                else if (rand < 0.7) { type = 'context'; color = '#1e90ff'; }
                else { type = 'dblclick'; color = '#ffa502'; }
            }

            mole.innerHTML = moleSVGs.normal(color);
            
            // éšæœºä½ç½®ï¼ˆé¿å¼€å·¦ä¸Šè§’çš„UIåŒºåŸŸï¼‰
            let x, y;
            do {
                x = Math.random() * (window.innerWidth - 100);
                y = Math.random() * (window.innerHeight - 100);
            } while (x < 350 && y < 200); // é¿å¼€å·¦ä¸Šè§’çš„UIåŒºåŸŸ
            
            mole.style.left = x + 'px';
            mole.style.top = y + 'px';

            // ç‚¹å‡»é€»è¾‘
            const handleHit = (e) => {
                e.preventDefault();
                mole.innerHTML = moleSVGs.hit(color);
                score += (type === 'dblclick' ? 30 : 10);
                scoreDisplay.innerText = score;
                
                // å‡»ä¸­åŠ¨ç”»
                document.body.classList.add('hammer-hit');
                setTimeout(() => document.body.classList.remove('hammer-hit'), 150);

                setTimeout(() => {
                    mole.remove();
                }, 300);
            };

            if(type === 'click') mole.onclick = handleHit;
            if(type === 'context') mole.oncontextmenu = handleHit;
            if(type === 'dblclick') mole.ondblclick = handleHit;

            gameCanvas.appendChild(mole);

            // 3ç§’ä¸æ‰“è‡ªåŠ¨æ¶ˆå¤±ï¼ˆæ ¹æ®é€Ÿåº¦è°ƒæ•´ï¼‰
            setTimeout(() => {
                if (mole.parentElement) mole.remove();
            }, speedConfig[gameSpeed].lifetime);
        }

        // æ¸¸æˆæ§åˆ¶å‡½æ•°
        function startGame() {
            // è·å–è®¾ç½®
            gameTime = parseInt(document.querySelector('#timeOptions .option-btn.active').dataset.time);
            gameMode = document.querySelector('#modeOptions .option-btn.active').dataset.mode;
            gameSpeed = document.querySelector('#speedOptions .option-btn.active').dataset.speed;
            remainingTime = gameTime;
            score = 0;
            
            // æ›´æ–°UI
            timerDisplay.innerText = remainingTime;
            scoreDisplay.innerText = score;
            updateInstructions();
            
            // æ˜¾ç¤ºæ¸¸æˆç•Œé¢
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('ui-layer').classList.remove('hidden');
            document.getElementById('gameCanvas').classList.remove('hidden');
            
            // å¼€å§‹è®¡æ—¶å™¨
            timerInterval = setInterval(() => {
                remainingTime--;
                timerDisplay.innerText = remainingTime;
                if (remainingTime <= 0) {
                    endGame();
                }
            }, 1000);
            
            // å¼€å§‹ç”Ÿæˆé¼¹é¼ ï¼ˆæ ¹æ®é€Ÿåº¦è°ƒæ•´é—´éš”ï¼‰
            gameInterval = setInterval(createMole, speedConfig[gameSpeed].interval);
        }
        
        function endGame() {
            // æ¸…ç†å®šæ—¶å™¨
            if (timerInterval) clearInterval(timerInterval);
            if (gameInterval) clearInterval(gameInterval);
            
            // æ¸…ç†æ‰€æœ‰é¼¹é¼ 
            document.querySelectorAll('.mole').forEach(mole => mole.remove());
            
            // æ˜¾ç¤ºç»“æŸé¡µé¢
            document.getElementById('ui-layer').classList.add('hidden');
            document.getElementById('gameCanvas').classList.add('hidden');
            document.getElementById('finalScore').innerText = score;
            document.getElementById('endScreen').classList.remove('hidden');
        }
        
        function restartGame() {
            document.getElementById('endScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }
        
        function updateInstructions() {
            let text = '';
            if (gameMode === 'left') text = 'ğŸ”´çº¢è‰²: å·¦é”®å•å‡»';
            else if (gameMode === 'right') text = 'ğŸ”µè“è‰²: å³é”®å•å‡»';
            else if (gameMode === 'both') text = 'ğŸ”´çº¢è‰²: å·¦é”®å•å‡» | ğŸ”µè“è‰²: å³é”®å•å‡»';
            else text = 'ğŸ”´çº¢è‰²: å·¦é”®å•å‡» | ğŸ”µè“è‰²: å³é”®å•å‡» | ğŸŸ¡é‡‘è‰²: åŒå‡»';
            instructionsDisplay.innerText = text;
        }
        
        // è®¾ç½®é€‰é¡¹åˆ‡æ¢
        document.getElementById('timeOptions').addEventListener('click', (e) => {
            if (e.target.classList.contains('option-btn')) {
                document.querySelectorAll('#timeOptions .option-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
            }
        });
        
        document.getElementById('modeOptions').addEventListener('click', (e) => {
            if (e.target.classList.contains('option-btn')) {
                document.querySelectorAll('#modeOptions .option-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
            }
        });
        
        document.getElementById('speedOptions').addEventListener('click', (e) => {
            if (e.target.classList.contains('option-btn')) {
                document.querySelectorAll('#speedOptions .option-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
            }
        });

        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }
    </script>
</body>
</html>